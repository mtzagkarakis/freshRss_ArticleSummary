<?php
$oai_url = FreshRSS_Context::$user_conf->oai_url;
$oai_key = FreshRSS_Context::$user_conf->oai_key;
$oai_model = FreshRSS_Context::$user_conf->oai_model;
$oai_prompt = FreshRSS_Context::$user_conf->oai_prompt ?: 'You are a concise RSS summarization engine. Extract only the most essential information.

Rules:
- **Maximum length: 30% of original article length** - be ruthlessly concise
- Focus on core facts: what happened, who, when, where, key numbers/outcomes
- Preserve critical names, dates, figures, and specific details
- Ignore boilerplate, ads, author bios, navigation, promotional content
- NO interpretation, speculation, or external knowledge
- NO meta-commentary about "the article" or summarization itself

Structure Guidelines:
- **Short articles** (< 300 words): Single paragraph with 2-4 key points
- **Medium articles** (300-800 words): 2-3 concise paragraphs organized by topic
- **Long articles** (> 800 words): Use ## section headings + brief bullet points

Format (markdown):
- **Bold** key terms, names, numbers, important concepts
- Bullet points (â€¢) for multiple distinct facts (keep bullets short: 1 line each)
- Prioritize information density over completeness

Output:
- Tone: neutral, direct, factual
- Write as direct information, not "The article states..."
- If no meaningful content: "No substantive content available to summarize."';
$oai_max_tokens = FreshRSS_Context::$user_conf->oai_max_tokens ?: 2048; // Default to 2048
$oai_temperature = FreshRSS_Context::$user_conf->oai_temperature ?: 1.0; // Default to 1.0
$oai_readability_default = FreshRSS_Context::$user_conf->oai_readability_default ?? false; // Default to false
?>

<form action="<?php echo _url('extension', 'configure', 'e', urlencode($this->getName())); ?>" method="post">
  <input type="hidden" name="_csrf" value="<?php echo FreshRSS_Auth::csrfToken(); ?>" />
  <div id="common_config">
    <label for="oai_url">Base URL (http(s)://oai.com/) without 'v1'</label>
    <input type="text" name="oai_url" id="oai_url" value="<?php echo $oai_url; ?>">
    <label for="oai_key">API Key</label>
    <input type="text" name="oai_key" id="oai_key" value="<?php echo $oai_key; ?>">
    <label for="oai_model">Model Name</label>
    <input type="text" name="oai_model" id="oai_model" value="<?php echo $oai_model; ?>">
    <label for="oai_prompt">Prompt (add before content)</label>
    <textarea name="oai_prompt" id="oai_prompt"><?php echo $oai_prompt; ?></textarea>
    <label for="oai_max_tokens">Max Completion Tokens (default: 2048)</label>
    <input type="number" name="oai_max_tokens" id="oai_max_tokens" value="<?php echo $oai_max_tokens; ?>" min="1" max="32000">
    <label for="oai_temperature">Temperature (0-2, default: 1.0)</label>
    <input type="number" name="oai_temperature" id="oai_temperature" value="<?php echo $oai_temperature; ?>" min="0" max="2" step="0.1">
    <label for="oai_readability_default">
      <input type="checkbox" name="oai_readability_default" id="oai_readability_default" value="1" <?php echo $oai_readability_default ? 'checked' : ''; ?>>
      Enable Reader Mode by default
    </label>
  </div>
  <hr />
  <button type="submit">Save</button>
</form>